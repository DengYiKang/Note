# Integer Replacement

### 问题

现有一个正整数`n`，可以做以下变换：

+ 若`n`为偶数，则可变换为`n/2`
+ 若`n`为奇数，则可变换为`n+1`或`n-1`

求`n`变换到1的最小步长。

### 解决方案：时间复杂度$O(logn)$，空间复杂度$O(1)$

对一个特定的数，有以下变换路线：

```
111011 -> 111010 -> 11101 -> 11100 -> 1110 -> 111 -> 1000 -> 100 -> 10 -> 1
```

```
111011 -> 111100 -> 11110 -> 1111 -> 10000 -> 1000 -> 100 -> 10 -> 1
```

可以发现，二进制表示里0位越多，步数越小。

因此有以下决策：

+ 若`n`为偶数，则变换为`n/2`
+ 若`n`为奇数，在`n+1`与`n-1`之间，哪个数的二进制表示中0位最多，则选取哪种路线。3除外，选择`n-1`

注意到，`n-1`中的0位始终+1，而对于`n+1`中的0位，考虑`01->10`，`...11->...00`，前者0位数不变，后者至少+1。因此，变换前的数若倒数第二位为0，那么选择`n-1`，否则选择`n+1`。

```java
class Solution {
    public int integerReplacement(int n) {
        int c = 0;
        while (n != 1) {
            if ((n & 1) == 0) {
                n >>>= 1;
            } else if (n == 3 || ((n >>> 1) & 1) == 0) {
                --n;
            } else {
                ++n;
            }
            ++c;
        }
        return c;
    }
}
```

